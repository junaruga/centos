dist: xenial
services:
  - docker
language: bash
addons:
    apt:
        config:
            retries: true
        update: true
        packages:
            # Install libguestfs-tools to use virt-tar-out command.
            # https://packages.ubuntu.com/xenial/libguestfs-tools
            - libguestfs-tools
env:
    global:
        - LIBGUESTFS_DEBUG=1
        - LIBGUESTFS_TRACE=1
    matrix:
        # Set available versions
        # https://wiki.centos.org/Manuals/ReleaseNotes
        # x86_64: http://cloud.centos.org/centos/7/images
        # others: http://mirror.centos.org/altarch/$VERSION/isos/$ARCH
        - VERSION=7.2.1511-x86_64
        - VERSION=7.3.1611-x86_64
        - VERSION=7.3.1704-x86_64
        - VERSION=7.6.1901-x86_64

before_install:
  - docker run --rm --privileged multiarch/qemu-user-static:register

script:
  # sudo is required for virt-tar-out in upsate.sh
  - sudo ./update.sh "${VERSION}"
